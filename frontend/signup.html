<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - EduPlatform</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-auth-compat.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="https://images.pexels.com/photos/267507/pexels-photo-267507.jpeg?auto=compress&cs=tinysrgb&w=100&h=100&fit=crop" alt="EduPlatform Logo" class="logo">
                <span class="logo-text">EduPlatform</span>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="courses.html" class="nav-link">Courses</a>
                <a href="login.html" class="nav-link">Login</a>
                <a href="signup.html" class="nav-link active">Sign Up</a>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <main class="auth-main">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <h1>Create Account</h1>
                    <p>Join thousands of learners and start your journey today</p>
                </div>

                <form id="signup-form" class="auth-form">
                    <div id="signup-message" class="message" style="display: none;"></div>
                    
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <span class="error-message" id="name-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <div class="input-group">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <span class="error-message" id="email-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="password">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" name="password" required>
                            <button type="button" class="toggle-password" id="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <span class="error-message" id="password-error"></span>
                        <div class="password-strength" id="password-strength">
                            <div class="strength-bar">
                                <div class="strength-fill"></div>
                            </div>
                            <span class="strength-text">Password strength</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="confirmPassword" name="confirmPassword" required>
                            <button type="button" class="toggle-password" id="toggle-confirm-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <span class="error-message" id="confirmPassword-error"></span>
                    </div>

                    <div class="form-options">
                        <label class="checkbox-container">
                            <input type="checkbox" id="terms" required>
                            <span class="checkmark"></span>
                            I agree to the <a href="#" target="_blank">Terms of Service</a> and <a href="#" target="_blank">Privacy Policy</a>
                        </label>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full" id="signup-btn">
                        <span class="btn-text">Create Account</span>
                        <i class="fas fa-spinner fa-spin btn-spinner" style="display: none;"></i>
                    </button>
                </form>

                <div class="auth-footer">
                    <p>Already have an account? <a href="login.html">Sign in here</a></p>
                </div>

                <div class="divider">
                    <span>or continue with</span>
                </div>

                <div class="social-login">
                    <button class="social-btn google-btn" id="google-signup">
                        <i class="fab fa-google"></i>
                        Google
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
  // Replace with your Firebase config snippet
  const firebaseConfig = {
    apiKey: "AIzaSyDkovYOVl1YEhP3_dxG7HQ_KgNubUqjz1E",
    authDomain: "online-lms-0327.firebaseapp.com",
    projectId: "online-lms-0327",
    appId: "1:237624913905:web:378b60ab0de974e1955e50"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // ✅ Signup form
  const signupForm = document.getElementById('signup-form');
  const signupMessage = document.getElementById('signup-message');

  signupForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirmPassword').value;

    if (password !== confirmPassword) {
      signupMessage.style.display = 'block';
      signupMessage.textContent = "⚠️ Passwords do not match!";
      return;
    }

    try {
      const userCredential = await auth.createUserWithEmailAndPassword(email, password);
      const user = userCredential.user;

      // Update display name
      await user.updateProfile({ displayName: name });

      // Send verification email
      await user.sendEmailVerification();
      alert("✅ Verification email sent! Please check your inbox.");

      window.location.href = "login.html";
    } catch (error) {
      signupMessage.style.display = "block";
      signupMessage.textContent = error.message;
    }
  });

  // ✅ Google Signup/Login
  document.getElementById('google-signup').addEventListener('click', async () => {
    const provider = new firebase.auth.GoogleAuthProvider();

    try {
      // For popup login on web
      const result = await auth.signInWithPopup(provider);

      // The signed-in user info
      const user = result.user;

      alert(`✅ Welcome ${user.displayName || "User"}!`);
      window.location.href = "courses.html";

    } catch (error) {
      // If popup blocked (like on mobile Safari), fallback to redirect
      if (error.code === "auth/operation-not-supported-in-this-environment") {
        try {
          await auth.signInWithRedirect(provider);
        } catch (redirectError) {
          signupMessage.style.display = "block";
          signupMessage.textContent = redirectError.message;
        }
      } else {
        signupMessage.style.display = "block";
        signupMessage.textContent = error.message;
      }
    }
  });

  // ✅ Password toggle
  const togglePassword = document.getElementById('toggle-password');
  togglePassword.addEventListener('click', () => {
    const passwordInput = document.getElementById('password');
    passwordInput.type = passwordInput.type === "password" ? "text" : "password";
  });
  const toggleConfirm = document.getElementById('toggle-confirm-password');
  toggleConfirm.addEventListener('click', () => {
    const confirmInput = document.getElementById('confirmPassword');
    confirmInput.type = confirmInput.type === "password" ? "text" : "password";
  });

  // ✅ Password strength (simple)
  const passwordInput = document.getElementById('password');
  const strengthFill = document.querySelector('.strength-fill');
  const strengthText = document.querySelector('.strength-text');
  passwordInput.addEventListener('input', () => {
    const val = passwordInput.value;
    let strength = 0;
    if (val.length >= 6) strength++;
    if (/[A-Z]/.test(val)) strength++;
    if (/[0-9]/.test(val)) strength++;
    if (/[\W]/.test(val)) strength++;
    const width = (strength / 4) * 100;
    strengthFill.style.width = width + '%';
    const textArr = ["Weak","Fair","Good","Strong"];
    strengthText.textContent = val ? textArr[strength-1] : "Password strength";
  });
</script>
